% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatiotemporal_partition.R
\name{spatiotemporal_partition}
\alias{spatiotemporal_partition}
\title{Spatiotemporal Cross-Validation Partitioning}
\usage{
spatiotemporal_partition(
  reference_shapefile_path,
  points_file_path,
  time_col = NULL,
  xcol = NULL,
  ycol = NULL,
  points_crs = NULL,
  n_spatial_folds = 0,
  n_temporal_folds = 0,
  n_balanced_folds = 0,
  max_imbalance = 0.05,
  generate_plots = TRUE,
  output_file = NULL
)
}
\arguments{
\item{reference_shapefile_path}{Character or sf object. Path to the study area
polygon or an \code{sf} polygon object defining the study region.}

\item{points_file_path}{Character, sf object, sfc object, Spatial object, or
data frame. Path to occurrence data (.csv, .shp, .geojson, .gpkg) or spatial object.}

\item{time_col}{Character. Column name for temporal blocking. Required if using
temporal or balanced folds.}

\item{xcol}{Character. Name of the x-coordinate column
when reading CSV or data frame. Required only if input is .csv, not sf or Spatial object.}

\item{ycol}{Character. Name of the y-coordinate column
when reading CSV or data frame. Required only if input is .csv, not sf or Spatial object.}

\item{points_crs}{Character or CRS object. CRS of input points if not embedded.
Required only if input is .csv, not sf or Spatial object.}

\item{n_spatial_folds}{Integer. Number of spatially explicit folds (ignored if using balanced folds).}

\item{n_temporal_folds}{Integer. Number of temporally explicit folds (ignored if using balanced folds).}

\item{n_balanced_folds}{Integer. Number of balanced folds to create, which simultaneously
balance spatial and temporal representation. Overrides n_spatial_folds and n_temporal_folds.}

\item{max_imbalance}{Numeric. Maximum allowed fold size imbalance as a proportion (0â€“1). Default is 0.05.}

\item{generate_plots}{Logical. If TRUE, generates diagnostic plots showing fold distributions. Default is TRUE.}

\item{output_file}{Character. Optional path to save results as an \code{.rds} file.}
}
\value{
A list containing:
\itemize{
  \item \code{pts_sf}: sf object of occurrence points with assigned folds and block types.
  \item \code{voronoi_sf}: sf object of Voronoi polygons for spatial blocks.
  \item \code{final_fold_counts}: Table of point counts per fold.
  \item \code{mean_per_fold}: Mean number of points per fold.
  \item \code{imbalance}: Maximum fold imbalance as a proportion.
  \item \code{n_spatially_exclusive_folds}: Number of spatially exclusive folds created.
  \item \code{n_temporally_exclusive_folds}: Number of temporally exclusive folds created.
  \item \code{n_spatial_exclusive_blocks}: Number of spatially exclusive blocks.
  \item \code{n_shared_blocks}: Number of shared blocks across folds.
  \item \code{plots}: List of ggplot objects (if \code{generate_plots = TRUE}).
}
}
\description{
Preprocesses species occurrence data by partitioning it into spatially and
temporally structured folds for cross-validation. Supports creation of
balanced folds, spatial-only, temporal-only, or spatiotemporal folds.
Generates spatial blocks using k-means clustering and assigns points to
folds according to user-defined strategies.
}
\details{
The function partitions data into folds using either a balanced approach
(simultaneously optimizing spatial and temporal representation) or separate
spatial/temporal explicit folds. Spatial blocks are generated with k-means
clustering and visualized using Voronoi tessellation. Temporal blocks are created based on
the \code{time_col}. Balanced folds attempt to distribute points evenly across
folds while enforcing spatial and temporal structure.

Partitioned datasets are suitable for cross-validation in modeling workflows,
ensuring spatial and temporal independence between folds.
}
\examples{
\dontrun{
partition_results <- spatiotemporal_partition(
  reference_shapefile_path = "study_area.shp",
  points_file_path = "occurrences.csv",
  time_col = "Year",
  xcol = "longitude",
  ycol = "latitude",
  points_crs = "EPSG:4326",
  n_balanced_folds = 4,
  max_imbalance = 0.05,
  generate_plots = TRUE
)
}

}
\seealso{
Preprocessing: \code{\link{spatiotemporal_rarefication}},
\code{\link{temporally_explicit_extraction}}

Modeling: \code{\link{build_hypervolume_models}}
}
